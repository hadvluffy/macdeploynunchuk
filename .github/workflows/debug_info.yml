name: debug_info

on:
  push:
    tags:
    - '*'

  workflow_dispatch:

jobs:
  build:
    runs-on: macos-15

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Download and install HWI
        run: |
          BINDIR="${{ runner.workspace }}/nunchuk-linux-v${{ env.LATEST_VERSION }}/Appdir/bin"
          HWI_URL="https://github.com/giahuy98/HWI/releases/download/3.1.0-coldcard/hwi-3.1.0-linux-x86_64.tar.gz"
          HWI_ARCHIVE="hwi.tar.gz"
      
          echo "Downloading HWI from $HWI_URL"
          wget -q "$HWI_URL" -O "$HWI_ARCHIVE"
      
          echo "Extracting HWI archive..."
          mkdir -p hwi-extracted
          tar -xzf "$HWI_ARCHIVE" -C hwi-extracted
      
          echo "Listing extracted files:"
          ls -l hwi-extracted
      
          echo "Copying HWI binary to $BINDIR..."
          mkdir -p "$BINDIR"
          cp hwi-extracted/hwi "$BINDIR/"
          chmod +x "$BINDIR/hwi"
      
          echo "HWI installed to $BINDIR"
          ls -l "$BINDIR"

      - name: Install aqt in venv and list ALL Qt versions, modules, architectures
        shell: bash
        run: |
          set -euo pipefail

          VENV_DIR="${{ runner.temp }}/pyvenv_aqt"
          rm -rf "$VENV_DIR"
          python3 -m venv "$VENV_DIR"
          source "$VENV_DIR/bin/activate"

          python -V
          pip install --upgrade pip setuptools wheel
          pip install aqtinstall

          echo "=== aqt executable location ==="
          which aqt || true
          aqt --version || true

          echo ""
          echo "=== ALL Qt versions available (mac desktop) ==="
          aqt list-qt mac desktop || true

          echo ""
          echo "=== ALL Qt versions + modules (including qtwebengine) ==="
          aqt list-qt mac desktop --modules || true

          echo ""
          echo "=== ALL Qt versions + architectures ==="
          aqt list-qt mac desktop --arch || true



